<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Đề Kiểm Tra Lịch Sử Số 14</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .timer {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-size: 24px;
            font-weight: bold;
        }

        .timer.warning {
            background: rgba(255,0,0,0.3);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .content {
            padding: 30px;
        }

        .section-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 30px 0 20px 0;
            font-size: 20px;
            font-weight: bold;
        }

        .question {
            background: #f8f9fa;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            border-left: 5px solid #667eea;
        }

        .question-title {
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
            font-size: 16px;
        }

        .options {
            margin-left: 20px;
        }

        .option {
            margin: 10px 0;
            display: flex;
            align-items: flex-start;
        }

        .option input[type="radio"],
        .option input[type="checkbox"] {
            margin-right: 10px;
            margin-top: 4px;
            cursor: pointer;
            width: 18px;
            height: 18px;
        }

        .option label {
            cursor: pointer;
            flex: 1;
        }

        .document-box {
            background: #fff8dc;
            border: 2px solid #daa520;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            font-style: italic;
            line-height: 1.8;
        }

        .submit-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            display: block;
            margin: 30px auto;
            transition: transform 0.2s;
        }

        .submit-btn:hover {
            transform: scale(1.05);
        }

        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .result-box {
            background: #e8f5e9;
            border: 3px solid #4caf50;
            padding: 25px;
            margin: 20px 0;
            border-radius: 10px;
            display: none;
        }

        .result-box.show {
            display: block;
        }

        .score {
            font-size: 32px;
            font-weight: bold;
            color: #2e7d32;
            text-align: center;
            margin: 20px 0;
        }

        .answer-key {
            margin-top: 30px;
        }

        .correct {
            background: #c8e6c9 !important;
            border-left-color: #4caf50 !important;
        }

        .incorrect {
            background: #ffcdd2 !important;
            border-left-color: #f44336 !important;
        }

        .correct-answer {
            color: #2e7d32;
            font-weight: bold;
            margin-top: 10px;
        }

        .user-answer {
            color: #c62828;
            font-weight: bold;
            margin-top: 5px;
        }

        .instruction {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .part2-item {
            margin-bottom: 15px;
            padding-left: 20px;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ĐỀ KIỂM TRA SỐ 14 - MÔN LỊCH SỬ</h1>
            <div class="timer" id="timer">Thời gian: 45:00</div>
        </div>

        <div class="content">
            <div class="instruction">
                <strong>Hướng dẫn:</strong><br>
                - Phần I: Mỗi câu hỏi chỉ chọn một phương án (24 câu × 0.25 điểm = 6 điểm)<br>
                - Phần II: Mỗi câu có 4 ý a, b, c, d - chọn Đúng hoặc Sai (4 câu, thang điểm: 1 ý đúng = 0.1đ, 2 ý = 0.25đ, 3 ý = 0.5đ, 4 ý = 1.0đ)<br>
                - Thời gian làm bài: 45 phút<br>
                - Nhấn "Nộp bài" để xem kết quả và đáp án
            </div>

            <div class="section-title">PHẦN I: Thí sinh trả lời câu hỏi từ 1 đến 24. Mỗi câu hỏi thí sinh chỉ chọn một phương án.</div>
            
            <div id="part1-questions"></div>

            <div class="section-title">PHẦN II: Thí sinh trả lời câu hỏi từ 1 đến 4. Trong mỗi ý a), b), c), d) ở mỗi câu, thí sinh chọn đúng hoặc sai.</div>
            
            <div id="part2-questions"></div>

            <button class="submit-btn" id="submitBtn">Nộp bài</button>

            <div class="result-box" id="resultBox">
                <h2 style="text-align: center; color: #2e7d32;">KẾT QUẢ BÀI KIỂM TRA</h2>
                <div class="score" id="scoreDisplay"></div>
                <div id="detailScore"></div>
            </div>
        </div>
    </div>

    <script>
        // Dữ liệu câu hỏi Phần 1
        const part1Questions = [
            {
                id: 1,
                question: "Thời điểm kinh tế Liên Xô và các nước Đông Âu bắt đầu suy giảm bắt đầu từ",
                options: [
                    "nửa sau những năm 70.",
                    "nửa đầu những năm 60.",
                    "nửa sau những năm 80.",
                    "nửa sau những năm 50."
                ],
                correct: 0
            },
            {
                id: 2,
                question: "Nội dung nào sau đây phản ánh đúng nhiệm vụ của cách mạng tháng Mười năm 1917 ở nước Nga?",
                options: [
                    "Lật đổ Chính phủ tư sản lâm thời.",
                    "Lật đổ chế độ phản động thuộc địa.",
                    "Lật đổ chế độ chuyên chế Nga hoàng.",
                    "Thống nhất đất nước về nhà nước."
                ],
                correct: 0
            },
            {
                id: 3,
                question: "Sự kiện nào sau đây đã đánh dấu dân tộc Việt Nam rơi vào thời kỳ Bắc thuộc?",
                options: [
                    "Khởi nghĩa Hai Bà Trưng thất bại (43).",
                    "Cuộc khởi nghĩa Bà Triệu bị đàn áp (248).",
                    "Cuộc khởi nghĩa của Lý Nam Đế (542).",
                    "Thất bại của An Dương Vương (179 TCN)."
                ],
                correct: 3
            },
            {
                id: 4,
                question: "Cuộc kháng chiến của nhà Hồ nhằm chống lại sự xâm lược của kẻ thù nào sau đây?",
                options: [
                    "Hán.",
                    "Minh.",
                    "Tống.",
                    "Nguyên."
                ],
                correct: 1
            },
            {
                id: 5,
                question: "Những quốc gia nào sau đây đóng vai trò quyết định, thống nhất thành lập tổ chức Liên hợp quốc?",
                options: [
                    "Liên Xô, Anh, Pháp.",
                    "Liên Xô, Mỹ, Đức.",
                    "Liên Xô, Mỹ, Anh.",
                    "Liên Xô, Nhật, Đức."
                ],
                correct: 2
            },
            {
                id: 6,
                question: "Trật tự thế giới hai cực Ian-ta sau Chiến tranh thế giới thứ hai có tác động như thế nào đối với Việt Nam?",
                options: [
                    "Việt Nam là nơi xảy ra cuộc chiến tranh cục bộ duy nhất.",
                    "Việt Nam trở thành tâm điểm của mâu thuẫn Đông - Tây.",
                    "Quá trình hội nhập của Việt Nam không đạt được kết quả.",
                    "Cách mạng ở Việt Nam gặp nhiều khó khăn và thử thách."
                ],
                correct: 3
            },
            {
                id: 7,
                question: "Năm 1997, hai quốc gia nào được kết nạp, trở thành thành viên thứ 8 và thứ 9 của Hiệp hội các quốc gia Đông Nam Á (ASEAN)?",
                options: [
                    "Việt Nam và Cam-pu-chia.",
                    "In-đô-nê-xi-a và Ma-lai-xi-a.",
                    "Phi-líp-pin và Xin-ga-po.",
                    "Lào và Mi-an-ma."
                ],
                correct: 3
            },
            {
                id: 8,
                question: "Năm 1963, tổ chức MAPHILINDO được thành lập bao gồm một trong những quốc gia nào sau đây?",
                options: [
                    "Việt Nam.",
                    "Cam-pu-chia.",
                    "Thái Lan.",
                    "In-đô-nê-xi-a."
                ],
                correct: 3
            },
            {
                id: 9,
                question: "Nội dung phản ánh đúng ý nghĩa của quá trình mở rộng thành viên từ ASEAN 5 đến ASEAN 10 là",
                options: [
                    "phù hợp với mong muốn, lợi ích của các nước trên thế giới.",
                    "góp phần nâng cao vị thế của Hiệp hội trên trường quốc tế.",
                    "làm phá sản hoàn toàn chiến lược toàn cầu của đế quốc Mỹ.",
                    "ASEAN trở thành tổ chức liên kết khu vực thành công nhất."
                ],
                correct: 1
            },
            {
                id: 10,
                question: "Sau Cách mạng tháng Tám năm 1945, quân đội quốc gia nào sau đây vào phía Nam vĩ tuyến 16 của Việt Nam để giải giáp quân đội Nhật Bản?",
                options: [
                    "Mỹ.",
                    "Anh.",
                    "Pháp.",
                    "Tưởng."
                ],
                correct: 1
            },
            {
                id: 11,
                question: "Một trong những điểm giống nhau của chiến lược Việt Nam hóa chiến tranh (1969-1973) và chiến lược chiến tranh cục bộ (1965-1968) mà Mỹ đã thực hiện ở miền Nam là",
                options: [
                    "lực lượng chiến đấu chủ yếu.",
                    "phạm vi thực hiện chiến tranh.",
                    "mục đích tiến hành chiến tranh.",
                    "thủ đoạn mới được thực hiện."
                ],
                correct: 2
            },
            {
                id: 12,
                question: "Một trong những nguyên nhân thúc đẩy quân dân Việt Nam phải tập trung lực lượng binh khí kỹ thuật để giải phóng miền Nam trước mùa mưa năm 1975 là",
                options: [
                    "Trung Quốc đã ép Việt Nam phải đánh nhanh.",
                    "khi mùa mưa đến vấn đề đánh lớn sẽ gặp bất lợi.",
                    "lo ngại Mỹ về việc sẽ can thiệp trở lại miền Nam.",
                    "nhằm tranh thủ nguồn viện trợ to lớn từ Liên Xô."
                ],
                correct: 1
            },
            {
                id: 13,
                question: "Trong thời kì chống Mỹ, cứu nước (1954 - 1975), miền Bắc Việt Nam thực hiện việc tiếp tế và chi viện thường xuyên cho cách mạng miền Nam chủ yếu qua tuyến đường nào sau đây?",
                options: [
                    "Đường hàng không quốc tế.",
                    "Căn cứ bí mật trên Trường Sa.",
                    "Mượn đường qua đất Thái Lan.",
                    "Đường mòn Hồ Chí Minh."
                ],
                correct: 3
            },
            {
                id: 14,
                question: "Một trong những thành tựu về kinh tế Việt Nam đạt được trong 5 năm đầu công cuộc đổi mới (1986 - 1990) là",
                options: [
                    "hoàn thành công nghiệp hóa đất nước.",
                    "trở thành nước xuất khẩu gạo hàng đầu.",
                    "xây dựng thành công nhà nước pháp quyền.",
                    "hàng tiêu dùng dồi dào hơn trước đó."
                ],
                correct: 3
            },
            {
                id: 15,
                question: "Nguyên nhân cơ bản dẫn đến khủng hoảng kinh tế - xã hội ở Việt Nam trong những năm 1976 - 1985 là do",
                options: [
                    "sai lầm về chủ trương, đường lối phát triển kinh tế.",
                    "cuộc khủng hoảng ở Liên Xô và các nước Đông Âu.",
                    "nền kinh tế hoàn toàn phụ thuộc vào xuất khẩu gạo.",
                    "chính sách cấm vận của Mĩ và các nước phương Tây."
                ],
                correct: 0
            },
            {
                id: 16,
                question: "Các hoạt động đối ngoại thực hiện trong giai đoạn từ sau cách mạng tháng Tám đến trước ngày 19-12-1946 có ý nghĩa như thế nào đối với cách mạng Việt Nam?",
                options: [
                    "Các nước xã hội chủ nghĩa đã công nhận Việt Nam.",
                    "Tập hợp quần chúng đứng dưới ngọn cờ của Đảng.",
                    "Tạo ra phong trào phản chiến mạnh mẽ ở châu Á.",
                    "Bảo vệ thành quả của cách mạng tháng Tám 1945."
                ],
                correct: 3
            },
            {
                id: 17,
                question: "Từ năm 1986 đến nay, Việt Nam đã ký các hiệp ước về biên giới trên đất liền với quốc gia nào sau đây?",
                options: [
                    "Trung Quốc.",
                    "Ấn Độ.",
                    "Liên Xô.",
                    "Triều Tiên."
                ],
                correct: 0
            },
            {
                id: 18,
                question: "Một trong những những hoạt động hỗ trợ nhân đạo của Việt Nam hiện nay đang được thực hiện ở",
                options: [
                    "Mỹ.",
                    "Đức.",
                    "Anh.",
                    "Cuba."
                ],
                correct: 3
            },
            {
                id: 19,
                question: "Một trong những điểm khác biệt trong con đường cứu nước của Nguyễn Ái Quốc so với Phan Châu Trinh là",
                options: [
                    "mục tiêu giải phóng dân tộc Việt Nam.",
                    "cống hiến hết mình cho cách mạng.",
                    "khuynh hướng cách mạng cứu nước.",
                    "ý chí mãnh liệt, muốn đất nước độc lập."
                ],
                correct: 2
            },
            {
                id: 20,
                question: "Một trong những quốc gia ở châu Á đã dựng tượng đài Chủ tịch Hồ Chí Minh là",
                options: [
                    "Ấn Độ.",
                    "Ai Cập.",
                    "Cuba.",
                    "An-giê-ri."
                ],
                correct: 0
            },
            {
                id: 21,
                question: "Nhận xét nào là đúng về quá trình khảo sát, lựa chọn con đường cứu nước mới cho dân tộc của Nguyễn Ái Quốc?",
                options: [
                    "Có vận dụng sáng tạo chủ nghĩa Mác – Lênin.",
                    "Tìm hiểu thực tế về chủ nghĩa quốc gia cải lương.",
                    "Chịu ảnh hưởng sâu sắc bởi \"Triết học Ánh sáng\".",
                    "Từ chủ nghĩa yêu nước đến chủ nghĩa cộng sản."
                ],
                correct: 3
            },
            {
                id: 22,
                question: "Nhận định nào sau đây là đúng về vai trò của Mặt trận Tổ quốc Việt Nam trong công cuộc đổi mới đất nước ở Việt Nam hiện nay?",
                options: [
                    "Công cụ thi hành chủ trương đường lối của Đảng và chính sách, pháp luật của nhà nước.",
                    "Điều kiện tiên quyết để kết nối với đồng bào Việt Nam ở nước ngoài hướng về Tổ quốc.",
                    "Cơ sở chính trị của chính quyền nhân dân, bảo vệ quyền, lợi ích hợp pháp của nhân dân.",
                    "Soạn thảo ra các văn bản pháp luật để bảo vệ quyền và lợi ích hợp pháp của người dân."
                ],
                correct: 2
            },
            {
                id: 23,
                question: "Thực tiễn cách mạng Việt Nam từ năm 1930 đã để lại bài học quý báu và xuyên suốt nào sau đây?",
                options: [
                    "Nắm vững ngọn cờ độc lập dân tộc và chủ nghĩa xã hội.",
                    "Sự nghiệp cách mạng là của Đảng Cộng sản Việt Nam.",
                    "Đẩy mạnh công tác tự phê trong nội bộ đảng cầm quyền.",
                    "Phát huy sự đoàn kết của nhân dân ba nước Đông Dương."
                ],
                correct: 0
            },
            {
                id: 24,
                question: "Nhận xét nào sau đây là đúng về việc thỏa thuận đóng quân và phân chia phạm vi ảnh hưởng giữa ba cường quốc trong Hội nghị Ianta (2/1945)?",
                options: [
                    "Phân chia phạm vi ảnh hưởng giữa Liên Xô và Pháp.",
                    "Thực chất là phân chia quyền lợi giữa Mĩ và Liên Xô.",
                    "Thiết lập một trật tự thế giới có lợi cho nhân lao động.",
                    "Thúc đẩy quá trình hình thành trật tự thế giới \"đa cực\"."
                ],
                correct: 1
            }
        ];

        // Dữ liệu câu hỏi Phần 2
        const part2Questions = [
            {
                id: 1,
                question: "Cho những thông tin trong bảng sau đây:",
                document: '<table style="width: 100%; border-collapse: collapse; margin: 10px 0;"><tr style="background: #f0f0f0;"><th style="border: 1px solid #ccc; padding: 10px;">Những thắng lợi tiêu biểu</th><th style="border: 1px solid #ccc; padding: 10px;">Nội dung chính</th></tr><tr><td style="border: 1px solid #ccc; padding: 10px;"><strong>Cuộc chiến đấu ở các đô thị phía Bắc vĩ tuyến 16</strong></td><td style="border: 1px solid #ccc; padding: 10px;">Diễn ra từ ngày 19 – 12 – 1946 đến 17 – 2 – 1947 ở các đô thị như: Nam Định, Vinh,... Đặc biệt, ở Hà Nội, các trận đánh ác liệt đã diễn ra tại khu vực Bắc Bộ Phủ, Bưu điện Bờ Hồ, ga Hàng Cỏ, phố Khâm Thiên,…</td></tr><tr><td style="border: 1px solid #ccc; padding: 10px;"><strong>Chiến dịch Việt Bắc thu – đông năm 1947</strong></td><td style="border: 1px solid #ccc; padding: 10px;">Diễn ra từ tháng 10 đến tháng 12 – 1947 khi thực dân Pháp mở cuộc tấn công lên Việt Bắc. Quân đội Việt Nam chủ động bao vây, tiến công đẩy lùi quân Pháp khỏi một số vị trí quan trọng: Chợ Đồn, Chợ Rã, Đoan Hùng,...</td></tr><tr><td style="border: 1px solid #ccc; padding: 10px;"><strong>Chiến dịch Biên giới thu – đông năm 1950</strong></td><td style="border: 1px solid #ccc; padding: 10px;">Diễn ra từ tháng 9 đến tháng 10 – 1950 ở khu vực biên giới Việt – Trung. Quân đội Việt Nam tấn công cứ điểm Đông Khê, mai phục, chặn đánh quân Pháp ở nhiều nơi trên Đường số 4, buộc chúng phải rút chạy.</td></tr><tr><td style="border: 1px solid #ccc; padding: 10px;"><strong>Chiến dịch Điện Biên Phủ 1954</strong></td><td style="border: 1px solid #ccc; padding: 10px;">Sau 56 ngày đêm chiến đấu liên tục, quân đội Việt Nam đã tiêu diệt toàn bộ quân địch ở tập đoàn cứ điểm Điện Biên Phủ. Chiến dịch toàn thắng vào ngày 7-5-1954.</td></tr></table>',
                subQuestions: [
                    {
                        id: 'a',
                        text: "Tư liệu đề cập đến những thắng lợi tiêu biểu về mặt quân sự trong cuộc kháng chiến toàn quốc chống thực dân Pháp.",
                        correct: true
                    },
                    {
                        id: 'b',
                        text: "Những chiến thắng trên mặt trận quân sự của Việt Nam đều góp phần đưa cuộc kháng chiến đi theo đường lối đã định.",
                        correct: true
                    },
                    {
                        id: 'c',
                        text: "Các chiến dịch quân sự của Việt Nam trong chống Pháp đều được tiến hành nhằm giữ vững thế chủ động tiến công.",
                        correct: false
                    },
                    {
                        id: 'd',
                        text: "Điện Biên Phủ là chiến dịch tiến công lớn nhất, đã kết thúc cuộc kháng chiến toàn quốc chống thực dân Pháp.",
                        correct: false
                    }
                ]
            },
            {
                id: 2,
                question: "Cho đoạn tư liệu sau đây:",
                document: '"Bên cạnh việc đổi mới về tư duy kinh tế là đổi mới về chính trị. Đại hội VI (12-1986) nhấn mạnh đến việc đổi mới về chính trị phải được tiến hành tích cực và vững chắc để không gây mất ổn định về chính trị và làm phương hại đến toàn bộ công cuộc đổi mới. Trong việc đổi mới về chính trị, Đảng phải chú trọng đến các vấn đề như, dân chủ hóa xã hội, "lấy dân làm gốc", đối mới nội dung, phương thức hoạt động của các đoàn thể quần chúng theo phương châm: "dân biết, dân bàn, dân làm, dân kiểm tra"…" <br><em>Nguyễn Ngọc Mão (Chủ biên), Lịch sử Việt Nam, tập 15, NXB. Khoa học xã hội 2017, tr. 38</em>',
                subQuestions: [
                    {
                        id: 'a',
                        text: "Tư liệu đề cập đến quan điểm đổi mới chính trị trong công cuộc đổi mới đất nước ở Việt Nam từ năm 1986.",
                        correct: true
                    },
                    {
                        id: 'b',
                        text: "Đổi mới chính trị là trọng tâm của công cuộc đổi mới, phải được tiến hành từng bước, vững chắc và tích cực.",
                        correct: false
                    },
                    {
                        id: 'c',
                        text: "Trong đổi mới chính trị, cần chú trọng quan điểm \"lấy dân làm gốc\", do nhân dân lãnh đạo và quản lý.",
                        correct: false
                    },
                    {
                        id: 'd',
                        text: "Công cuộc đổi mới ở Việt Nam được tiến hành toàn diện và đồng bộ, kiên định mục tiêu của chủ nghĩa xã hội.",
                        correct: true
                    }
                ]
            },
            {
                id: 3,
                question: "Cho đoạn tư liệu sau đây:",
                document: '"Trật tự thế giới này được hình thành như thế nào, còn tùy thuộc ở nhiều nhân tố: Sự phát triển về thực lực kinh tế, chính trị, quân sự của các cường quốc Mỹ, Nga, Trung Quốc, Anh, Pháp, Nhật Bản, Đức trong cuộc chạy đua về sức mạnh quốc gia tổng hợp…; Sự lớn mạnh của lực lượng cách mạng thế giới (sự thành bại của công cuộc cải cách, đổi mới ở các nước xã hội chủ nghĩa);…Sự phát triển của cách mạng khoa học-kĩ thuật sẽ còn tiếp tục tạo ra những "đột phá" và biến chuyển trên cục diện thế giới".<br><em>(Nguyễn Anh Thái (Chủ biên), Lịch sử thế giới hiện đại, NXB Giáo dục Việt Nam, Hà Nội, 2021, tr.424)</em>',
                subQuestions: [
                    {
                        id: 'a',
                        text: "Tư liệu đề cập đến sự hình thành của trật tự thế giới mới sau Chiến tranh lạnh.",
                        correct: true
                    },
                    {
                        id: 'b',
                        text: "Sau Chiến tranh lạnh, trật tự thế giới mới lấy phát triển kinh tế làm trọng tâm.",
                        correct: true
                    },
                    {
                        id: 'c',
                        text: "Sự lớn mạnh của hệ thống xã hội chủ nghĩa có tác động đến trật tự thế giới mới.",
                        correct: false
                    },
                    {
                        id: 'd',
                        text: "Trật tự thế giới mới đã và đang hình thành theo xu thế đa cực, nhiều trung tâm.",
                        correct: true
                    }
                ]
            },
            {
                id: 4,
                question: "Cho đoạn tư liệu sau đây:",
                document: '"Việc Việt Nam trở thành thành viên đầy đủ của ASEAN là một mốc lịch sử trong quan hệ quốc tế ở Đông Nam Á, đã tăng cường vai trò, vị trí của ASEAN với tư cách một tổ chức khu vực quan trọng, góp phần thúc đẩy xu thế hoà bình, ổn định, hợp tác, phát triển và thịnh vượng chung ở Đông Nam Á. Việt Nam gia nhập ASEAN đã góp phần tạo môi trường khu vực thuận lợi cho sự phát triển của Việt Nam trong sự phát triển chung của khu vực, nâng cao vị trí và vai trò của Việt Nam tại Đông Nam Á".<br><em>(Nguyễn Đình Bin (chủ biên), Ngoại giao Việt Nam 1945 – 2000, NXB Chính trị quốc gia, Hà Nội, 2005, tr.351)</em>',
                subQuestions: [
                    {
                        id: 'a',
                        text: "Tư liệu khẳng định vai trò, vị trí của Việt Nam đối với sự phát triển của tổ chức ASEAN.",
                        correct: true
                    },
                    {
                        id: 'b',
                        text: "Sự kiện Việt Nam gia nhập ASEAN đã quyết định đến sự phát triển, ổn định của khu vực.",
                        correct: false
                    },
                    {
                        id: 'c',
                        text: "Việc Việt Nam gia nhập ASEAN đã thúc đẩy quá trình hòa giải, hòa bình ở Đông Nam Á.",
                        correct: true
                    },
                    {
                        id: 'd',
                        text: "Hiện nay, ASEAN đã trở thành tổ chức khu vực lớn nhất, có vị trí quan trọng trên thế giới.",
                        correct: false
                    }
                ]
            }
        ];

        // Hàm tráo đề
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // Tráo câu hỏi và đáp án
        const shuffledPart1 = part1Questions.map(q => {
            const shuffledOptions = shuffleArray(q.options.map((opt, idx) => ({text: opt, isCorrect: idx === q.correct})));
            return {
                ...q,
                options: shuffledOptions.map(o => o.text),
                correct: shuffledOptions.findIndex(o => o.isCorrect)
            };
        });

        const shuffledPart2 = part2Questions.map(q => ({
            ...q,
            subQuestions: shuffleArray(q.subQuestions)
        }));

        // Render Phần 1
        function renderPart1() {
            const container = document.getElementById('part1-questions');
            shuffledPart1.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.id = 'p1q' + q.id;
                
                let html = '<div class="question-title">Câu ' + q.id + '. ' + q.question + '</div>';
                html += '<div class="options">';
                
                q.options.forEach((option, optIndex) => {
                    const letter = String.fromCharCode(65 + optIndex);
                    html += '<div class="option"><input type="radio" name="q' + q.id + '" id="q' + q.id + '_' + optIndex + '" value="' + optIndex + '"><label for="q' + q.id + '_' + optIndex + '">' + letter + '. ' + option + '</label></div>';
                });
                
                html += '</div>';
                questionDiv.innerHTML = html;
                container.appendChild(questionDiv);
            });
        }

        // Render Phần 2
        function renderPart2() {
            const container = document.getElementById('part2-questions');
            shuffledPart2.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.id = 'p2q' + q.id;
                
                let html = '<div class="question-title">Câu ' + q.id + ': ' + q.question + '</div>';
                html += '<div class="document-box">' + q.document + '</div>';
                
                q.subQuestions.forEach(sub => {
                    html += '<div class="part2-item"><strong>' + sub.id + ')</strong> ' + sub.text + '<br><div style="margin-top: 8px; margin-left: 20px;"><label style="margin-right: 20px;"><input type="radio" name="q' + q.id + '_' + sub.id + '" value="true"> Đúng</label><label><input type="radio" name="q' + q.id + '_' + sub.id + '" value="false"> Sai</label></div></div>';
                });
                
                questionDiv.innerHTML = html;
                container.appendChild(questionDiv);
            });
        }

        // Đồng hồ đếm ngược
        let timeLeft = 45 * 60;
        const timerElement = document.getElementById('timer');
        
        function updateTimer() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerElement.textContent = 'Thời gian: ' + minutes.toString().padStart(2, '0') + ':' + seconds.toString().padStart(2, '0');
            
            if (timeLeft <= 5 * 60) {
                timerElement.classList.add('warning');
            }
            
            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                submitExam();
            }
            
            timeLeft--;
        }
        
        const timerInterval = setInterval(updateTimer, 1000);

        // Chấm điểm
        function gradeExam() {
            let part1Score = 0;
            let part2Score = 0;
            const results = {part1: [], part2: []};
            
            // Chấm Phần 1
            shuffledPart1.forEach(q => {
                const selected = document.querySelector('input[name="q' + q.id + '"]:checked');
                const userAnswer = selected ? parseInt(selected.value) : -1;
                const isCorrect = userAnswer === q.correct;
                
                if (isCorrect) part1Score += 0.25;
                
                results.part1.push({
                    id: q.id,
                    correct: isCorrect,
                    userAnswer: userAnswer,
                    correctAnswer: q.correct
                });
            });
            
            // Chấm Phần 2
            shuffledPart2.forEach(q => {
                let correctCount = 0;
                const subResults = [];
                
                q.subQuestions.forEach(sub => {
                    const selected = document.querySelector('input[name="q' + q.id + '_' + sub.id + '"]:checked');
                    const userAnswer = selected ? selected.value === 'true' : null;
                    const isCorrect = userAnswer === sub.correct;
                    
                    if (isCorrect) correctCount++;
                    
                    subResults.push({
                        id: sub.id,
                        correct: isCorrect,
                        userAnswer: userAnswer,
                        correctAnswer: sub.correct
                    });
                });
                
                // Tính điểm theo thang
                if (correctCount === 1) part2Score += 0.1;
                else if (correctCount === 2) part2Score += 0.25;
                else if (correctCount === 3) part2Score += 0.5;
                else if (correctCount === 4) part2Score += 1.0;
                
                results.part2.push({
                    id: q.id,
                    correctCount: correctCount,
                    subResults: subResults
                });
            });
            
            return {
                part1Score: Math.round(part1Score * 100) / 100,
                part2Score: Math.round(part2Score * 100) / 100,
                totalScore: Math.round((part1Score + part2Score) * 100) / 100,
                results: results
            };
        }

        // Hiển thị kết quả
        function displayResults(gradeResults) {
            const resultBox = document.getElementById('resultBox');
            const scoreDisplay = document.getElementById('scoreDisplay');
            const detailScore = document.getElementById('detailScore');
            
            scoreDisplay.innerHTML = 'Tổng điểm: ' + gradeResults.totalScore + '/10';
            detailScore.innerHTML = '<p style="text-align: center; font-size: 18px;">Phần I: ' + gradeResults.part1Score + '/6 điểm<br>Phần II: ' + gradeResults.part2Score + '/4 điểm</p>';
            
            resultBox.classList.add('show');
            
            // Hiển thị đáp án đúng/sai cho Phần 1
            gradeResults.results.part1.forEach(r => {
                const questionDiv = document.getElementById('p1q' + r.id);
                questionDiv.classList.add(r.correct ? 'correct' : 'incorrect');
                
                if (!r.correct) {
                    const correctLetter = String.fromCharCode(65 + r.correctAnswer);
                    const userLetter = r.userAnswer >= 0 ? String.fromCharCode(65 + r.userAnswer) : 'Không chọn';
                    
                    const answerInfo = document.createElement('div');
                    answerInfo.innerHTML = '<div class="user-answer">Bạn chọn: ' + userLetter + '</div><div class="correct-answer">Đáp án đúng: ' + correctLetter + '</div>';
                    questionDiv.appendChild(answerInfo);
                }
            });
            
            // Hiển thị đáp án cho Phần 2
            gradeResults.results.part2.forEach(r => {
                const questionDiv = document.getElementById('p2q' + r.id);
                questionDiv.classList.add(r.correctCount === 4 ? 'correct' : 'incorrect');
                
                const answerInfo = document.createElement('div');
                answerInfo.innerHTML = '<div style="margin-top: 15px; padding: 10px; background: #fff3cd; border-radius: 5px;"><strong>Kết quả: ' + r.correctCount + '/4 ý đúng</strong><br>';
                
                r.subResults.forEach(sub => {
                    const icon = sub.correct ? '✓' : '✗';
                    const color = sub.correct ? '#2e7d32' : '#c62828';
                    const userText = sub.userAnswer === null ? 'Không chọn' : (sub.userAnswer ? 'Đúng' : 'Sai');
                    const correctText = sub.correctAnswer ? 'Đúng' : 'Sai';
                    
                    answerInfo.innerHTML += '<div style="margin: 5px 0; color: ' + color + ';">' + icon + ' <strong>' + sub.id + ')</strong> Bạn chọn: <strong>' + userText + '</strong> - Đáp án: <strong>' + correctText + '</strong></div>';
                });
                
                answerInfo.innerHTML += '</div>';
                questionDiv.appendChild(answerInfo);
            });
        }

        // Nộp bài
        function submitExam() {
            clearInterval(timerInterval);
            document.getElementById('submitBtn').disabled = true;
            
            // Vô hiệu hóa tất cả input
            document.querySelectorAll('input[type="radio"], input[type="checkbox"]').forEach(input => {
                input.disabled = true;
            });
            
            const gradeResults = gradeExam();
            displayResults(gradeResults);
            
            // Cuộn đến kết quả
            document.getElementById('resultBox').scrollIntoView({behavior: 'smooth'});
        }

        document.getElementById('submitBtn').addEventListener('click', submitExam);

        // Khởi tạo
        renderPart1();
        renderPart2();
        updateTimer();
    </script>
</body>
</html>
